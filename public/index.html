<!DOCTYPE html>
<html>

<head>
    <meta name="google-signin-client_id" content="660289313316-3gs0lge9kmgmtbk3urpbf2clphj4brdg.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script src="https://apis.google.com/js/api.js" ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    
    <!-- Custom styles -->
    <link href="style.css" rel="stylesheet">
    <style type="text/css">
        
    </style>
    <script src="phaser.min.js"></script>
    <script src="game.js"></script>
</head>

<body>

    <!--Google signin-->
    <div class="g-signin2" data-onsuccess="onSignIn">
        <button type="button" onclick="signIn()">Sign In</button>
    </div>
    
    <a href="#" onclick="signOut();">Sign out</a>
<script>
  function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
      console.log('User signed out.');
    });
  }

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            document.getElementById("message").innerHTML = profile.getName();
            console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
        }

        
        
              function sendData() {
        $.ajax({
        type:"GET",
        cache:false,
        url:"/checkI",
        data:{score: document.getElementById("scoreValue").innerHTML, name: document.getElementById("message").innerHTML},    // multiple data sent using ajax
        success: function( result ) {
            var obj = JSON.parse(result);
                   
                    var tbl=$("<table/>").attr("id","mytable");
            $("#div1").append(tbl);
                    for(var i=0;i<obj.length;i++)
                    {
                        var tr="<tr>";
                        var td1="<td>"+obj[i]["name"]+"</td>";
                        var td2="<td>"+obj[i]["score"]+"</td></tr>";

                        
                       $("#mytable").append(tr+td1+td2);
                    }
        
        
        
            $( "#demo" ).html( "<strong>" + result + "</strong>" );
        }
      });
      
      if (this.readyState == 4 && this.status == 200) {
                    //document.getElementById("demo2").innerHTML = JSON.stringify
                    /*var obj = JSON.parse(this.responseText);
                    console.log(this.responseText);
                    var tbl=$("<table/>").attr("id","mytable");
                    $("#div1").append(tbl);
                    for(var i=0;i<obj.length;i++)
                    {
                        var tr="<tr>";
                        var td1="<td>"+obj[i]["name"]+"</td>";
                        var td2="<td>"+obj[i]["score"]+"</td></tr>";

                        
                       $("#mytable").append(tr+td1+td2); 
                      
                    }*/
                    
                    $.getJSON(JSON.parse(this.responseText), {}, function(data) {
            var $ul = $('#ul').attr("id","ct");
            $.each(data, function(idx, item){
                $ul.append('<li style="color: ' + item.name + '">' + item.score  +'</li>')
            })
        });
                }
        }  
    </script>

<br><br>
    Hello, <span id="message"></span>

    
    
    <br><br><br><br>
    <h2>Score:<span id="scoreValue"> 0</span></h2>
    <br>
    
    <button id="add" type="button" onclick="sendData()">Submit score</button>
    <!--<button id="add" type="button" onclick="loadDoc()">Submit score</button>-->
    
    <br><br>
    
    <div id="div1"> Table of Scores
    <table id="mytable"></table>
    </div>
    
    <p id="demo">demo</p>
    <p id="demo2"></p>
    

    <ul id="ct"></ul>

    <!--Script to give GET request to server
    <script>
        function loadDoc() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("demo").innerHTML = this.responseText;
                }
            };
            xhttp.open("GET", "/checkI", true);
            xhttp.send();
        }
    </script>-->
    
    <script>

    </script>
</body>

</html>